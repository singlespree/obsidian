---
создал заметку: 2024-07-01
---
## Основные понятия

1. Выделение памяти:
- Память в Go может быть выделена на [[Стек]] или в [[Куча]]
- Переменные с коротким временем жизни обычно выделяются на стеке. Когда функция завершается, [[Стек]] автоматически очищается.
- Переменные с долгосрочным временем жизни выделяются в куче, где память управляется [[Garbage Collector, GC]]
2. [[Стек]]
- Управление памятью на стеке осуществляется быстро, так как стек имеет упорядоченную структуру и освобождается автоматически. 
- Размер стека фиксируется, и если стек заполняется([[переполнение стека]]), программа может аварийно завершиться. 
3. [[Куча]]
- Это более сложная структура памяти, используемая для динамического выделения и освобождения памяти. 
- [[Garbage Collector, GC]] регулярно очищает неиспользуемые объекты из кучи, чтобы предотвратить [[Утечка памяти]]. 
4. [[Garbage Collector, GC]]
- Сборщик мусора автоматически находит и освобождает память, которая больше не используется. 
- Это позволяет разработчикам не беспокоиться о явном освобождении памяти, уменьшает вероятность утечек памяти, но накладывает свой накладной механизм. 

### Выделение памяти

Функции [[new]] и [[make]] широко используются в Go для выделения памяти:

- [[new]] выделяет память и возвращает указатель на эту память. 
`p := new(int) // Выделяет память для int и возвращает указатель *int`

- [[make]] используется для создания [[Срезы(Slice)]], [[Карты(maps)]], [[Каналы(channels)]]
`s := make([]int, 10) // Создает срез длиной 10`

### Примеры разницы между [[Стек]] и [[Куча]]

```
package main

import "fmt"

// Куча: глобальная переменная, будет существовать до завершения программы
var global *int

func main() {
    local := 42  // Переменная на стеке: будет удалена, когда функция main завершится
    global = &local

    fmt.Println(*global)
}

func f() {
    // Стек: переменная будет удалена, когда функция f завершится
    local := 10
    _ = local
}
```

В этом примере: 
- Переменная `local` в функции `main` выделяется на [[Стек]]
- `global` - это указатель на глобальную переменную, и она будет выделена в куче. 
- В функции `f()` переменная `local` также выделяется на [[Стек]]