---
создал заметку: 2024-06-30
---
### Куча(heap) - область памяти, используемая для динамического выделения памяти в процессе выполнения программы. В этой области данные могут существовать в течение всего времени работы программы, если явно не освобождаются.

## Ключевые моменты
1. Управление памятью:
	- Когда вы создаёте переменные и [[Типы Struct]] с помощью оператора `new` или функции `make`, они размещаются в куче. Например: `x := new(int)` или `m := make(map[string]int)`
	- Переменные, выделенные в куче, управляются системой сборки мусора ([[Garbage Collector, GC]]). Сборщик мусора автоматически освобождает память, когда она больше не используется, предотвращая утечки памяти.
2. Скорость доступа: 
	- Операции с памятью на куче обычно медленнее, чем операции с памятью на стеке, из-за затрат на управление кучей и работы сборщика мусора. 
3. Перемещение в кучу: 
	- Компилятор Go решает, будет ли переменная размещена на стеке или куче, основываясь на её времени жизни. Если переменная может быть доступна после выхода из функции(например, возвращается указатель на локальную переменную), она будет размещена в куче.
4. Отладка и мониторинг:
	 - Go предоставляет инструменты для мониторинга использования памяти, такие, как пакет [[runtime]] и профилирование с использование [[pprof]] 
5. Пример использования кучи: 
	- Когда вы создаёте переменную с использованием [[new]] или [[make]], она размещается в куче:

```
    package main

     import "fmt"

     func main() {
         // Создание указателя на int, который размещается в куче
         x := new(int)
         *x = 42
         fmt.Println(*x)

         // Создание среза int, который размещается в куче
         s := make([]int, 10)
         s[0] = 42
         fmt.Println(s[0])
     }
```

В этом примере `x` и `s` размещаются в куче, потому что они создаются с использованием [[new]] и [[make]] соответственно.