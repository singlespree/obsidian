---
создал заметку: 2024-06-30
---
Функция `new` используется для выделения памяти для нового экземпляра указанного типа и возвращает [[Указатели]] на этот экземпляр. В отличие от функции [[make]], которая инициализирует и возвращает конкретные встроенные типы([[Срезы(Slice)]], [[Карты(maps)]], [[Каналы(channels)]]), `new` работает с любыми типами данных и просто выделяет память, устанавливая все поля в нулевое значение по умолчанию. 

Функция `new` принимает тип, как аргумент и возвращает [[Указатели]] на новое значение этого типа

```
package main

import (
    "fmt"
)

func main() {
    // Использование new для создания целого числа
    p := new(int)
    fmt.Println(*p)  // 0, так как значение по умолчанию для int - это 0

    // Присваивание значения
    *p = 42
    fmt.Println(*p)  // 42

    // Использование new для создания структуры
    type Person struct {
        Name string
        Age  int
    }
    person := new(Person)
    fmt.Println(*person) // { 0}, так как значения по умолчанию для string и int - это "" и 0 соответственно

    // Присваивание значений полям структуры
    person.Name = "Alice"
    person.Age = 30
    fmt.Println(*person) // {Alice 30}
}
```

Пояснение: 
1. Выделение памяти для `int`
   `p := new(int)`
Здесь `p` является [[Указатели]] на целое число, которое было инициализировано значением по умолчанию 0. Когда мы используем оператор разыменования `*p`, мы можем получить и изменить это значение. 

2. Работа с указателями на структуру. 
```
type Person struct {
       Name string
       Age  int
   }
   person := new(Person)
```

Здесь `person` является указателем на структуру `Person`, где `Name` и `Age` инициализированы значениями по умолчанию `""` и `0` соответственно

Отличия от функции [[make]]
- Тип данных: `new` работает с любыми типами данных, в то время как [[make]] используется только для [[Срезы(Slice)]], [[Карты(maps)]] и [[Каналы(channels)]]
- Возврат значения: `new` возвращает указатель на выделенную память, инициализированную значением по умолчанию. `make` возвращает инициализированное значение, готовое к использованию. 
- Инициализация: `new` только выделяет память и инициализирует её нулевым значением, не выполняя дополнительных шагов по настройке типа. `make`, помимо выделения памяти, производит дополнительную инициализацию [[Срезы(Slice)]], [[Каналы(channels)]] и [[Карты(maps)]], необходимых для их полноценного использования. 

### Когда использовать `new`
Использовать `new` имеет смысл, когда вам нужно создать указатель на значение типа и инициализировать его значением по умолчанию. Это может быть полезно в ситуациях, когда требуется работать с указателями напрямую, строить динамические структуры данных или создавать структуры значения которых могут быть изменены в различных частых программы. 

Пример: 
```
func main() {
    arr := new([10]int)  // Создание указателя на массив из 10 элементов
    fmt.Println(arr)     // &{0 0 0 0 0 0 0 0 0 0}
}

type Node struct {
    Value int
    Next  *Node
}

func main() {
    node := new(Node)  // Создание указателя на структуру Node
    node.Value = 10
    node.Next = new(Node)
    node.Next.Value = 20
    fmt.Println(node)       // &{10 0xc00000c030}
    fmt.Println(node.Next)  // &{20 <nil>}
}
```

В этих примерах используются [[Указатели]] для создания динамических структур данных, таких как [[Массив]] и [[связанные списки]]

